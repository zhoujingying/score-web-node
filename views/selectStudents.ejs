<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>查找学生</title>
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/js/ejs.min.js">
    <script type="text/javascript" src="/js/jquery.js"></script>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="container">
        <ul class="nav nav-pills">
            <li><a href="/">首页</a></li>
            <li><a href="/addStudent">新增学生</a></li>
            <li><a href="/selectStudents">查询学生</a></li>
        </ul>
    </div>
</nav>
<div class="form-group">
    <label for="select-student-text">格式：学号，学号,...</label>
    <input type="text" class="form-control" id="select-student-text" name="stuNum">
</div>

<button type="button" class="btn btn-default" id="btn">确认</button>


<% if(code === 1){%>
<div class="show-stu-info">
    <p>成绩单</p>
    <% stuInfo.forEach(function (val) { %>
    <div class="stu-list">
        <p>姓名|数学|语文|英语|编程|平均分|总分</p>
        <p>================================</p>
        <% val.stuInfo.forEach(function (stuVal) { %>
        <p>
            <span><%= stuVal.name %></span>|<span><%= stuVal.subject.Math %></span>|<span><%= stuVal.subject.Chinese %></span>|<span><%= stuVal.subject.English %></span>
            |<span id="stu-program"><%= stuVal.subject.program %></span>|<span><%= stuVal.stuScore.aveScore %></span>|<span><%= stuVal.stuScore.totalScore %></span>
        </p>
        <% }) %>

        <p>================================</p>
        <p>全班平均分为：<span><%= val.classAveScore %></span></p>
        <p>全班中位分为：<span><%= val.classMiddleScore %></span></p>
    </div>
    <% }) %>
    <p><a href="/">返回主界面</a></p>
</div>
<%}%>
</body>
</html>

<script>
    $(function () {
        function getValue() {
            return{
                stuNum:$('#select-student-text').val()
            }
        }
        $('#btn').on('click',function () {
            $.ajax({
                type:'post',
                url:'/selectStudents',
                data:getValue(),
                dataType:'json',
                success:function(result){
                    if(!result){
                        alert('查找失败');
                    }else {
//                        window.location.reload();
                    }
                }
            })
        })
    })
</script>